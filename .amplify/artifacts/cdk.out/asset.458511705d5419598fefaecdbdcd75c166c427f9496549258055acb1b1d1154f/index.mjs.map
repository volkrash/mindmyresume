{
  "version": 3,
  "sources": ["../../../../node_modules/@aws-amplify/backend-function/src/lambda-shims/cjs_shim.ts", "../../../../amplify/functions/rewriteResume/handler.js"],
  "sourcesContent": ["import { createRequire } from 'node:module';\nimport path from 'node:path';\nimport url from 'node:url';\nglobal.require = createRequire(import.meta.url);\nglobal.__filename = url.fileURLToPath(import.meta.url);\nglobal.__dirname = path.dirname(__filename);\n", "// amplify/functions/rewriteResume/handler.js\n\n// No TypeScript, no CommonJS \u2013 pure JS + ESM export\n\nfunction corsHeaders() {\n    return {\n        \"Content-Type\": \"application/json\",\n        \"Access-Control-Allow-Origin\": \"*\",\n        \"Access-Control-Allow-Headers\": \"Content-Type\",\n        \"Access-Control-Allow-Methods\": \"OPTIONS,POST\",\n    };\n}\n\nexport const handler = async (event) => {\n    try {\n        // Handle CORS preflight if the browser sends OPTIONS\n        if (event.requestContext?.http?.method === \"OPTIONS\") {\n            return {\n                statusCode: 204,\n                headers: corsHeaders(),\n                body: \"\",\n            };\n        }\n\n        if (!event.body) {\n            return {\n                statusCode: 400,\n                headers: corsHeaders(),\n                body: JSON.stringify({ error: \"Missing body\" }),\n            };\n        }\n\n        // Parse JSON body safely\n        let parsed;\n        try {\n            parsed =\n                typeof event.body === \"string\"\n                    ? JSON.parse(event.body || \"{}\")\n                    : event.body || {};\n        } catch (e) {\n            console.error(\"Invalid JSON body:\", e);\n            return {\n                statusCode: 400,\n                headers: corsHeaders(),\n                body: JSON.stringify({ error: \"Invalid JSON body\" }),\n            };\n        }\n\n        const resumeText = parsed.resumeText;\n        const jobDescription = parsed.jobDescription;\n        const language = parsed.language; // \"en\" | \"es\" expected\n        const mode = parsed.mode || \"standard\"; // (future: \"federal\")\n\n        if (!resumeText || typeof resumeText !== \"string\") {\n            return {\n                statusCode: 400,\n                headers: corsHeaders(),\n                body: JSON.stringify({ error: \"resumeText is required\" }),\n            };\n        }\n\n        // --- DEMO LOGIC ---\n        // Here is where you\u2019ll later drop your real AI call.\n        const isSpanish = language === \"es\";\n        const prefix = isSpanish\n            ? mode === \"federal\"\n                ? \"VERSI\u00D3N FEDERAL OPTIMIZADA (demo): \"\n                : \"VERSI\u00D3N OPTIMIZADA (demo): \"\n            : mode === \"federal\"\n                ? \"FEDERAL OPTIMIZED VERSION (demo): \"\n                : \"OPTIMIZED VERSION (demo): \";\n\n        const snippet = resumeText.length > 200\n            ? resumeText.slice(0, 200) + \"\u2026\"\n            : resumeText;\n\n        const rewrittenText = `${prefix}${snippet}`;\n\n        return {\n            statusCode: 200,\n            headers: corsHeaders(),\n            body: JSON.stringify({\n                rewrittenText,\n                jobDescription: jobDescription || null,\n                mode,\n            }),\n        };\n    } catch (err) {\n        console.error(\"Rewrite Lambda error:\", err);\n        return {\n            statusCode: 500,\n            headers: corsHeaders(),\n            body: JSON.stringify({\n                error: \"INTERNAL_ERROR\",\n                details: String(err && err.message ? err.message : err),\n            }),\n        };\n    }\n};"],
  "mappings": ";AAAA,OAAS,iBAAAA,MAAqB,cAC9B,OAAOC,MAAU,YACjB,OAAOC,MAAS,WAChB,OAAO,QAAUF,EAAc,YAAY,GAAG,EAC9C,OAAO,WAAaE,EAAI,cAAc,YAAY,GAAG,EACrD,OAAO,UAAYD,EAAK,QAAQ,UAAU,ECD1C,SAASE,GAAc,CACnB,MAAO,CACH,eAAgB,mBAChB,8BAA+B,IAC/B,+BAAgC,eAChC,+BAAgC,cACpC,CACJ,CAEO,IAAMC,EAAU,MAAOC,GAAU,CACpC,GAAI,CAEA,GAAIA,EAAM,gBAAgB,MAAM,SAAW,UACvC,MAAO,CACH,WAAY,IACZ,QAASF,EAAY,EACrB,KAAM,EACV,EAGJ,GAAI,CAACE,EAAM,KACP,MAAO,CACH,WAAY,IACZ,QAASF,EAAY,EACrB,KAAM,KAAK,UAAU,CAAE,MAAO,cAAe,CAAC,CAClD,EAIJ,IAAIG,EACJ,GAAI,CACAA,EACI,OAAOD,EAAM,MAAS,SAChB,KAAK,MAAMA,EAAM,MAAQ,IAAI,EAC7BA,EAAM,MAAQ,CAAC,CAC7B,OAASE,EAAG,CACR,eAAQ,MAAM,qBAAsBA,CAAC,EAC9B,CACH,WAAY,IACZ,QAASJ,EAAY,EACrB,KAAM,KAAK,UAAU,CAAE,MAAO,mBAAoB,CAAC,CACvD,CACJ,CAEA,IAAMK,EAAaF,EAAO,WACpBG,EAAiBH,EAAO,eACxBI,EAAWJ,EAAO,SAClBK,EAAOL,EAAO,MAAQ,WAE5B,GAAI,CAACE,GAAc,OAAOA,GAAe,SACrC,MAAO,CACH,WAAY,IACZ,QAASL,EAAY,EACrB,KAAM,KAAK,UAAU,CAAE,MAAO,wBAAyB,CAAC,CAC5D,EAMJ,IAAMS,EADYF,IAAa,KAEzBC,IAAS,UACL,yCACA,iCACJA,IAAS,UACL,qCACA,6BAEJE,EAAUL,EAAW,OAAS,IAC9BA,EAAW,MAAM,EAAG,GAAG,EAAI,SAC3BA,EAEAM,EAAgB,GAAGF,CAAM,GAAGC,CAAO,GAEzC,MAAO,CACH,WAAY,IACZ,QAASV,EAAY,EACrB,KAAM,KAAK,UAAU,CACjB,cAAAW,EACA,eAAgBL,GAAkB,KAClC,KAAAE,CACJ,CAAC,CACL,CACJ,OAASI,EAAK,CACV,eAAQ,MAAM,wBAAyBA,CAAG,EACnC,CACH,WAAY,IACZ,QAASZ,EAAY,EACrB,KAAM,KAAK,UAAU,CACjB,MAAO,iBACP,QAAS,OAAOY,GAAOA,EAAI,QAAUA,EAAI,QAAUA,CAAG,CAC1D,CAAC,CACL,CACJ,CACJ",
  "names": ["createRequire", "path", "url", "corsHeaders", "handler", "event", "parsed", "e", "resumeText", "jobDescription", "language", "mode", "prefix", "snippet", "rewrittenText", "err"]
}
